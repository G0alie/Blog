---
layout: default
title: OpenVAS
---

<body>
  <h1>OpenVAS Intro</h1>
  <p>OpenVAS is a vulnerability scanning and management framework that originated as a fork of the Nessus vulnerability scanner, which is widely in use in the industry.  To show some basics of the tool, I'm going to use it on the HackTheBox Legacy machine that I did a writeup for <a href="Blog/HackTheBox_Legacy.html">here</a>.  This will allow you to go back and see how I could have used OpenVAS to scan the machine to find the same vulnerability that I exploited in the writeup.</p>
  <p>First, let's get OpenVAS set up if this is the first time runnin it on your Kali machine.  Enter the following two commands in the terminal.  The second command will take a while, so be patient.  When it is finished you will see the admin password displayed.  Keep that saved somewhere</p>
  <blockquote>apt install openvas<br>openvas-setup</blockquote>
  <p>Now that OpenVAS is set up, type the following command to get started.</p>
  <blockquote>openvas-start</blockquote>
  <p>Hover over the configuration tab and select Targets.  In the top left corner of the page, you'll see a question mark and a star.  The question mark is on each page and will provide all the info on various aspects and symbols found on the page.  To create a new target, select the star.</p>
  <img src="https://i.postimg.cc/qvn5jbw0/target.png" alt="Target"/>
  <p>Enter the information on the target such as the name and the target IP address</p>
  <img src="https://i.postimg.cc/W1v19KVw/setup.png" alt="setup"/>
  <p>Time to start the scan.  Navigate to the Scans tab and select Tasks.  Select the star in the top left corner like last time and create the task.  Name it whatever you'd like and select the target, which you named earlier.  Hit Create and the click the start button next to the new task that has been set up.  Now, we wait.</p>
  <img src="https://i.postimg.cc/y8KjjVb6/Scan.png" alt"scan"/>
  <p>When the scan is complete, hover over the Scans tab and select Results.</p>
  <img src="https://i.postimg.cc/fyz9Lnxw/results.png" alt="results"/>
  <p>This is where the fun begins.  We can get a lot from this page.  The donut chart shows the results categorized by severity.  In this case, there are only high severity results and logs created by OpenVAS.  The bar graph on the right works similarly.  Remote and SMB show up frequently, and we know this thanks to the word cloud of the results in the middle show.  It is Looking like there may be some remote code execution on an SMB vulnerability.  The table at the bottom lists out vulnerabilites and relative info such as the severity.  Let's dig deeper and click on the first high severity vulnerability.</p>
  <img src="https://i.postimg.cc/bNQ1Rgvc/high.png" alt="high"/>
  <p>Lot's of great details can be found here.  This vulnerability exists thanks to an error in how SMB is handling certain requests.  It is confirmed by sending an SMB transaction request with FID=0(file identifier).  Down towards the bottom we see some CVE's.  Researching that first CVE brings us <a href="https://www.cvedetails.com/cve-details.php?t=1&cve_id=CVE-2017-0143">to this CVE Details page</a>.  This page shows that there are five metasploit modules for this vulnerability, which are identified at the bottom.  EternalBlue shows up as well as EternalRomance, which I used to exploit the Legacy machine.  Check out the writeup on <a href="Blog/HackTheBox_Legacy.html">how to exploit this machine. </a></p>
</body>
